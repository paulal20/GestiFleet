<div class="concesionarios-content">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1><%= title %></h1>
        <!-- Botón "Nuevo" solo para Admins -->
        <% if (usuario && usuario.rol === 'Admin') { %>
            <a href="/concesionarios/nuevo" class="btn btn-success">
                <span class="lang lang-es">Nuevo Concesionario</span>
                <span class="lang lang-en d-none">New Dealership</span>
            </a>
        <% } %>
    </div>

    <!-- Mensaje de Error (si existe) -->
    <% if (typeof error !== 'undefined' && error) { %>
      <div class="alert alert-danger" role="alert" aria-live="assertive">
        <%= error %>
      </div>
    <% } %>


    <% if (concesionarios && concesionarios.length > 0) { %>
        <div class="table-responsive-md">
            <table class="table table-hover">
                <caption class="text-center">
                    <span class="lang lang-es">Concesionarios mostrados: </span>
                    <span class="lang lang-en d-none">Dealerships shown: </span>
                    <strong><%= concesionarios.length %></strong>
                </caption>

                <thead class="table-dark">
                    <tr>
                        <th scope="col">Nombre</th>
                        <th scope="col">Ciudad</th>
                        <th scope="col">Dirección</th>
                        <th scope="col">Teléfono</th>
                        <th scope="col">Acciones</th>
                    </tr>
                </thead>

                <tbody>
                    <% concesionarios.forEach(c => { %>
                        <tr>
                            <td><%= c.nombre %></td>
                            <td><%= c.ciudad %></td>
                            <td><%= c.direccion %></td>
                            <td><%= c.telefono_contacto %></td>
                            <td>
                                <a href="/concesionarios/<%= c.id_concesionario %>" class="btn btn-primary btn-sm" title="Ver Detalle">
                                    Ver
                                </a>
                                
                                <% if (usuario && usuario.rol === 'Admin') { %>
                                    <a href="/concesionarios/<%= c.id_concesionario %>/editar" class="btn btn-secondary btn-sm" title="Editar">
                                        Editar
                                    </a>
                                    <form action="/concesionarios/<%= c.id_concesionario %>/eliminar" method="POST" style="display: inline-block; margin-left: 5px;" onsubmit="return confirm('¿Estás seguro de que quieres eliminar este concesionario?');">
                                        <button type="submit" class="btn btn-danger btn-sm" title="Eliminar">
                                            Eliminar
                                        </button>
                                    </form>
                                <% } %>
                            </td>
                        </tr>
                    <% }) %>
                </tbody>
            </table>
        </div>

    <% } else if (typeof error === 'undefined' || !error) { %> 
        <div class="alert alert-info text-center" role="alert">
            <h4 class="alert-heading">No hay concesionarios</h4>
            <p class="mb-0">No se encontraron concesionarios en la base de datos.</p>
        </div>
    <% } %>
</div>