<div class="listausuarios-content">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1><%= title %></h1>
        <a href="/usuarios/nuevo" class="btn btn-primary btn-lg">
            <span class="lang lang-es">Nuevo Usuario</span>
            <span class="lang lang-en d-none">New User</span>
        </a>
    </div>

    <% if (typeof error !== 'undefined' && error) { %>
        <div class="alert alert-danger" role="alert" aria-live="assertive">
            <%= error %>
        </div>
    <% } %>

    <% if (usuarios && usuarios.length > 0) { %>
        <div class="table-responsive-md">
            <table class="table table-hover">
                <caption class="text-center">
                    <span class="lang lang-es">Usuarios mostrados: </span>
                    <span class="lang lang-en d-none">Users shown: </span>
                    <strong><%= usuarios.length %></strong>
                </caption>

                <thead class="table-dark">
                    <tr>
                        <th scope="col">Nombre</th>
                        <th scope="col">Correo</th>
                        <th scope="col">Rol</th>
                        <th scope="col">Teléfono</th>
                        <th scope="col">Concesionario</th>
                        <th scope="col">Acciones</th>
                    </tr>
                </thead>

                <tbody>
                    <% usuarios.forEach(u => { %>
                        <tr>
                            <td class="fila-click" data-href="/usuarios/<%= u.id_usuario %>"><%= u.nombre %></td>
                            <td class="fila-click" data-href="/usuarios/<%= u.id_usuario %>"><%= u.correo %></td>
                            <td class="fila-click" data-href="/usuarios/<%= u.id_usuario %>"><%= u.rol %></td>
                            <td class="fila-click" data-href="/usuarios/<%= u.id_usuario %>"><%= u.telefono || '—' %></td>
                            <td class="fila-click" data-href="/usuarios/<%= u.id_usuario %>">
                                <%= u.nombre_concesionario || '—' %>
                            </td>

                            <td>
                                <button 
                                    type="button"
                                    class="btn btn-outline-secondary btn-sm"
                                    data-bs-toggle="modal"
                                    data-bs-target="#confirmarEliminarUsuarioModal"
                                    data-id="<%= u.id_usuario %>"
                                    data-name="<%= u.nombre %>"
                                >
                                    Eliminar
                                </button>
                                <a href="/usuarios/<%= u.id_usuario %>/editar" class="btn btn-primary btn-sm" title="Editar">
                                    <span class="lang lang-es">Editar</span>
                                    <span class="lang lang-en d-none">Edit</span>
                                </a>
                            </td>
                        </tr>
                    <% }) %>
                </tbody>
            </table>
        </div>

    <% } else { %>
        <div class="alert alert-info text-center" role="alert">
            <h4 class="alert-heading lang lang-es">No hay usuarios</h4>
            <h4 class="alert-heading lang lang-en d-none">No users found</h4>
            <p class="lang lang-es mb-0">No se encontraron usuarios registrados.</p>
            <p class="lang lang-en d-none mb-0">No users were found.</p>
        </div>
    <% } %>

</div>

<div class="modal fade" id="confirmarEliminarUsuarioModal" tabindex="-1" aria-labelledby="confirmarEliminarUsuarioModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title" id="confirmarEliminarUsuarioModalLabel">Eliminar Usuario</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>

      <div class="modal-body">
        <p id="textoConfirmacion">¿Estás seguro de que quieres eliminar este usuario?</p>

        <div class="d-flex justify-content-end mt-3 gap-2">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>

          <form id="formEliminarUsuario" action="" method="POST" class="m-0 p-0">
            <button type="submit" class="btn btn-danger">Eliminar</button>
          </form>
        </div>
      </div>

    </div>
  </div>
</div>

<script src="/js/modal.js"></script>
